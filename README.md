# ü§ñ Telegram Support Bot

AI-–±–æ—Ç —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å –≥–æ–ª–æ—Å–æ–≤—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, —É–º–Ω—ã–º –ø–æ–∏—Å–∫–æ–º –ø–æ FAQ, fallback-–æ—Ç–≤–µ—Ç–∞–º–∏ –æ—Ç GPT4All –∏–ª–∏ ChatGPT –∏ –≤–µ–±-–∞–¥–º–∏–Ω–∫–æ–π –Ω–∞ Django.

## üì¶ –§—É–Ω–∫—Ü–∏–∏

- üéôÔ∏è –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (Whisper)
- üìö –ü–æ–∏—Å–∫ –ø–æ FAQ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–º—ã—Å–ª–æ–≤—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ (Sentence Transformers)
- üí¨ Fallback –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–∑:
  - GPT4All (–ª–æ–∫–∞–ª—å–Ω–æ)
  - ChatGPT (—á–µ—Ä–µ–∑ OpenAI API)
- üßæ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –±–∞–∑—É
- üõ†Ô∏è Django-–∞–¥–º–∏–Ω–∫–∞:
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ –æ—Ç–≤–µ—Ç –ø–æ –æ–±—Ä–∞—â–µ–Ω–∏—è–º
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ FAQ
  - –ö–Ω–æ–ø–∫–∞ ¬´üìå –ó–±–µ—Ä–µ–≥—Ç–∏ –≤ FAQ¬ª –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- ‚úÖ –ö–Ω–æ–ø–∫–∏ ¬´–î–æ–ø–æ–º–æ–≥–ª–æ / –ù–µ –¥–æ–ø–æ–º–æ–≥–ª–æ¬ª –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üîÅ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ FAQ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

![–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](support_bot_architecture.png)

## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

```bash
git clone https://github.com/osart-admin/telegram-support-bot.git
cd telegram-support-bot

cp .env.example .env  # –Ω–∞—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
docker compose up --build

telegram-support-bot/
‚îú‚îÄ‚îÄ bot/                 # Telegram bot (Aiogram)
‚îÇ   ‚îú‚îÄ‚îÄ bot.py
‚îÇ   ‚îú‚îÄ‚îÄ db_logger.py
‚îÇ   ‚îú‚îÄ‚îÄ fallback_chain.py
‚îÇ   ‚îú‚îÄ‚îÄ transcribe.py
‚îÇ   ‚îî‚îÄ‚îÄ embeddings/      # build_index.py
‚îú‚îÄ‚îÄ web/                 # Django admin
‚îÇ   ‚îî‚îÄ‚îÄ supportapp/
‚îÇ       ‚îú‚îÄ‚îÄ models.py
‚îÇ       ‚îú‚îÄ‚îÄ admin.py
‚îÇ       ‚îú‚îÄ‚îÄ handlers.py
‚îÇ       ‚îî‚îÄ‚îÄ templates/admin/...
‚îú‚îÄ‚îÄ db/                  # faq_index.pkl
‚îú‚îÄ‚îÄ audio/               # –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
‚îú‚îÄ‚îÄ models/              # GPT4All .gguf
‚îî‚îÄ‚îÄ docker-compose.yml

‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
	‚Ä¢	GPT4All —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ .gguf-—Ñ–∞–π–ª (Mistral).
	‚Ä¢	–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è fallback —á–µ—Ä–µ–∑ openai.ChatCompletion.

ü§ñ Bot (Telegram-–±–æ—Ç)

üß± –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
	‚Ä¢	Python 3.10
	‚Ä¢	Aiogram 3 ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Telegram Bot Framework
	‚Ä¢	aiohttp ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã (–¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π)
	‚Ä¢	gpt4all ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è LLM (–Ω–∞–ø—Ä–∏–º–µ—Ä, Mistral gguf)
	‚Ä¢	openai ‚Äî fallback –∫ ChatGPT —á–µ—Ä–µ–∑ API
	‚Ä¢	whisper / transcribe_audio ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ç–µ–∫—Å—Ç
	‚Ä¢	sentence-transformers ‚Äî –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –¥–ª—è FAQ-–ø–æ–∏—Å–∫–∞
	‚Ä¢	scikit-learn ‚Äî cosine_similarity –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –±–ª–∏–∂–∞–π—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞
	‚Ä¢	MySQLdb ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏–π –∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –±–∞–∑—É (—á–µ—Ä–µ–∑ db_logger.py)
	‚Ä¢	Docker ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

üîß –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
	‚Ä¢	–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤—ã–µ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
	‚Ä¢	–°–Ω–∞—á–∞–ª–∞ –∏—â–µ—Ç –æ—Ç–≤–µ—Ç –≤ FAQ (–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫)
	‚Ä¢	–ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç GPT4All (–ª–æ–∫–∞–ª—å–Ω–æ), –∏ –µ—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ ‚Äî –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ ChatGPT
	‚Ä¢	–õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã –≤ –±–∞–∑—É
	‚Ä¢	–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫–∏ ‚úÖ –î–æ–ø–æ–º–æ–≥–ª–æ / ‚ùå –ù–µ –¥–æ–ø–æ–º–æ–≥–ª–æ
	‚Ä¢	–†–µ–∞–ª–∏–∑—É–µ—Ç callback_query-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

‚∏ª

üåê Web (–∞–¥–º–∏–Ω–∫–∞ –∏ –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π)

üß± –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
	‚Ä¢	Django 5.2.1
	‚Ä¢	Python 3.10
	‚Ä¢	Django Admin ‚Äî —É–¥–æ–±–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
	‚Ä¢	MySQL (—á–µ—Ä–µ–∑ mysqlclient)
	‚Ä¢	Whitenoise ‚Äî –ø–æ–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏
	‚Ä¢	python-dotenv ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
	‚Ä¢	telegram (python-telegram-bot==13.15) ‚Äî –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram
	‚Ä¢	sentence-transformers ‚Äî –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ FAQ-–∏–Ω–¥–µ–∫—Å–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
	‚Ä¢	huggingface_hub[hf_xet] ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–µ–π

üîß –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
	‚Ä¢	–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ FAQ, –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ Django Admin
	‚Ä¢	–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ Telegram (–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ, –±–µ–∑ –¥—É–±–ª–µ–π)
	‚Ä¢	–ö–Ω–æ–ø–∫–∞ üìå –ó–±–µ—Ä–µ–≥—Ç–∏ –≤ FAQ –≤ –∞–¥–º–∏–Ω–∫–µ
	‚Ä¢	–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ faq_index.pkl –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ FAQ
	‚Ä¢	–°–∏–≥–Ω–∞–ª—ã Django (post_save) –¥–ª—è –ª–æ–≥–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

‚∏ª

üê≥ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
	‚Ä¢	Docker Compose —É–ø—Ä–∞–≤–ª—è–µ—Ç 3 —Å–µ—Ä–≤–∏—Å–∞–º–∏:
	‚Ä¢	bot ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å Telegram-–±–æ—Ç–æ–º
	‚Ä¢	web ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å Django
	‚Ä¢	mysql ‚Äî –ë–î MySQL 8.0
	‚Ä¢	volume ./db:/app/db ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ FAQ-–∏–Ω–¥–µ–∫—Å–∞
	‚Ä¢	volume ./audio:/app/audio ‚Äî –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≥–æ–ª–æ—Å–æ–≤—ã–µ —Ñ–∞–π–ª—ã
	‚Ä¢	volume /opt/models:/models ‚Äî gguf-–º–æ–¥–µ–ª–∏ –¥–ª—è GPT4All
